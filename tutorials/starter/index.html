<!DOCTYPE html>
<html lang="en">
<head>
    <title>Harvest | Tutorials</title>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta property="og:title" content=Harvest | Tutorials/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://tfukaza.github.io/harvest/logo.png"/>
    <link rel="icon" href="/favicon.ico" />

    <link href="/harvest-website/asset/prism.css" rel="stylesheet">
    <link href="/harvest-website/css/main.css" rel="stylesheet">
    
    <link href="/harvest-website/css/tutorial_page.css" rel="stylesheet" ">
    
</head>
<body> 
     <nav>
    <a id="logo" href="/harvest-website/" ></a>
    <ul>
        <li><a href="/harvest-website/tutorials">Tutorials</a></li>
        <li><a href="/harvest-website/docs">Docs</a></li>
    </ul>
    <a id="github" href="https://github.com/tfukaza/harvest"><img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" /></a>
</nav>
    <main>
        <article>
    <header>
        <h1>Startup Guide</h1>
    </header>

    <h2>Introduction</h2>
<p>This is a beginner friendly startup guide to set up
your first algorithmic trading system using Harvest.
Through this tutorial, you will code an algorithm
which trades Twitter stocks using the moving average crossover strategy.</p>
<p>We won't go too deep into details of the framework nor
trading concepts, and instead focus will be on getting
the code up and running.</p>
<h2>What You Need</h2>
<ul>
<li>Python 3.9 or newer</li>
<li>A code editing software</li>
</ul>
<p>You should also take this time to set up a way to
manage your Python versions and packages, using libraries
like <code>virtualenv</code> and <code>conda</code>. This is especially important
since as of 2021, Python that comes pre-installed with
computers are usually Python 3.8 or older, meaning you
will have to upgrade it. This can be a surprisingly difficult
process, so take your time!</p>
<h2>Installing</h2>
<p>First things first, let's install the library.</p>
<pre><code class="language-bash">pip install harvest-python
</code></pre>
<p>Next, we install additional libraries depending on which
broker you want to use. Harvest will do this automatically,
using the following command:</p>
<pre><code class="language-bash">pip install harvest-python[API]
</code></pre>
<p>Where API is replaced by one of the following supported by Harvest:</p>
<ul>
<li>Robinhood</li>
<li>Alpaca</li>
<li>Polygon</li>
<li>Kraken</li>
</ul>
<h2>The Code</h2>
<p>Once you have everything installed, we are ready to begin writing the code. For this example we will use Robinhood, but the code is still mostly the same if you decide to use other brokers.</p>
<p>For this tutorial, there are three components of Harvest
you need to know:</p>
<ul>
<li>Trader: The main class responsible for managing the other classes.</li>
<li>API: The class that communicates with the brokerage you are using.</li>
<li>Algo: The class where you define your algorithm.</li>
</ul>
<p>Create a file called <code>algo.py</code> and begin coding in it.</p>
<p>We begin by importing the aforementioned components,
or, modules, as they are called in Python.</p>
<pre><code class="language-python">from harvest.algo import BaseAlgo
from harvest.trader import LiveTrader
from harvest.api.robinhood import Robinhood
</code></pre>
<p>Next we start writing out algorithm. Algorithms are created by extending the BaseAlgo class.</p>
<pre><code class="language-python">class MyAlgo(BaseAlgo):
    pass
</code></pre>
<p>There are three methods in the Algo class that you can define.</p>
<ul>
<li>config: Method to initialize parameters for your algorithm.</li>
<li>setup: Method called right before the algorithm starts. We won't be using this for this tutorial.</li>
<li>main: Method that runs the main logic of the algorithm.</li>
</ul>
<p>We first define the config method.</p>
<pre><code class="language-python">class MyAlgo(BaseAlgo):
    
    def config(self):
        self.watchlist=[&quot;TWTR&quot;]
        self.interval=&quot;5MIN&quot;
</code></pre>
<p><code>watchlist</code> is a list of stock symbols we want to track. Since
we are only tracking Twitter stocks, which has the symbol TWTR,
we set it to <code>[&quot;TWTR&quot;]</code>.</p>
<p><code>interval</code> specifies the rate we want to run the algorithm at.
For this algorithm, we arbitrarily decide to check Twitter
stock prices every <code>5MIN</code>.</p>
<p>Next we define the actual logic.</p>
<pre><code class="language-python">    def main(self):
</code></pre>
<p>In short, the moving average crossover strategy works by calculating the average value of the stock over a certain period of time - one for a relatively short period, and another much longer. This strategy states that when the value of the shorter average crosses below the longer average it is a buy, and when it crosses over it's a sell.</p>
<p>So we first need to calculate the two averages. This can be done by calling BaseAlgo class's <code>sma</code> function. We pass in the <code>period</code> parameter to specify how to calculate the average.</p>
<pre><code class="language-python">    def main(self):
        short_avg = self.sma(period=20)
        long_avg = self.sma(period=50)
</code></pre>
<p><code>sma</code> returns a list of the SMA values. Now we need to check if the latest values in the two lists cross over. For example, if short_avg is [20,30,40] and long_avg is [30,31,32], then we need to trigger a sell. Lucky for you, Harvest comes with a method to do just this - <code>crossover()</code>! This returns True if the first list just crossed over the second list.</p>
<pre><code class="language-python">    def main(self):
        short_avg = self.sma(period=20)
        long_avg = self.sma(period=50)
        if self.crossover(short_avg, long_avg):
            self.sell()
        elif self.crossover(long_avg, short_avg):
            self.buy()
</code></pre>
<p>The <code>buy</code> and <code>sell</code> methods are pretty self-explanatory. When <code>buy</code> is called without any parameters, it will take the first stock in the watchlist (TWTR) and buy as many as it can. Likewise, <code>sell</code> will
sell all owned stocks of the first stock in watchlist.</p>
<p>Finally, we create an instance of the trader class to use this algorithm, and run it.</p>
<pre><code class="language-python">if __name__ == &quot;__main__&quot;:
    t = LiveTrader( Robinhood() )
</code></pre>
<p>This creates the Trader class, and also tells it that
we will be using Robinhood to get stock data and place orders.</p>
<p>Lastly, we specify an instance of the <code>MyAlgo</code> class to the trader,
and run it.</p>
<pre><code class="language-python">    t.set_algo(MyAlgo())
    t.run()
</code></pre>
<p>Below is the final code after putting everything together.</p>
<pre><code class="language-python">from harvest.algo import BaseAlgo
from harvest.trader import LiveTrader
from harvest.api.robinhood import Robinhood

class MyAlgo(BaseAlgo):
    
    def config(self):
        self.watchlist=[&quot;TWTR&quot;]
        self.interval=&quot;5MIN&quot;

    def main(self):
        short_avg = self.sma(period=20)
        long_avg = self.sma(period=50)
        if self.crossover(short_avg, long_avg):
            self.sell()
        elif self.crossover(long_avg, short_avg):
            self.buy()
    
if __name__ == &quot;__main__&quot;:
    t = LiveTrader( RobinhoodBroker() )
    t.set_algo( MyAlgo() )
    t.run()
</code></pre>
<h2>Running the code</h2>
<p>You can now run your code:</p>
<pre><code class="language-bash">python algo.py
</code></pre>
<p>If this is the first time running your code, a program will start up to guide you through the process of connecting the algorithm to your broker.</p>
<p>Note that buying and selling stocks within the same day is called day-trading, and comes with legal restrictions. So after running the algorithm for a few minutes, make sure to shut it down before it makes too many trades.</p>

</article>
    </main>
    <footer>
   
    <div>
        <div>

        <a href="https://github.com/tfukaza/harvest/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5B%F0%9F%AA%B0BUG%5D">Report a Bug</a>
        <a href="https://github.com/tfukaza/harvest/issues/new?assignees=&labels=enhancement%2C+question&template=feature-request.md&title=%5B%F0%9F%92%A1Feature+Request%5D">Suggest a Feature</a>
    </div>
  </div>
</footer>
    <script src="/asset/prism.js"></script>
</body>
